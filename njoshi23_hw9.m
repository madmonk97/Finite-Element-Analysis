function[N, dNdp, dNdx] = njoshi23_hw9(xe, p)

nne = length(xe);

if nne == 4
    [N, dNdp] = shape_quad4(p);
elseif nne == 8
    [N, dNdp] = shape_quad8(p);
end

J = xe*dNdp;
dNdx = dNdp/J;

end

function[N, dNdp] = shape_quad4(p)

N = (1/4)*[(1-p(1))*(1-p(2));
           (1+p(1))*(1-p(2));
           (1+p(1))*(1+p(2));
           (1-p(1))*(1+p(2))];

dNdp = (1/4)*[ -1+p(2), -1+p(1);
                1-p(2), -1-p(1);
                1+p(2), 1+p(1);
                -1-p(2), 1-p(1)];

end

function[N, dNdp] = shape_quad8(p)

N = (1/4)*[-(1-p(1))*(1-p(2))*(1+p(1)+p(2));
           -(1+p(1))*(1-p(2))*(1-p(1)+p(2));
           -(1+p(1))*(1+p(2))*(1-p(1)-p(2));
           -(1-p(1))*(1+p(2))*(1+p(1)-p(2));
           2*(1-p(1)^2)*(1-p(2)); 
           2*(p(1)+1)*(1-p(2)^2);
           2*(1-p(1)^2)*(1+p(2));
           2*(1-p(1))*(1-p(2)^2)]; 
       
dNdp = (1/4)*[ 2*p(1)+p(2)-2*p(1)*p(2)-p(2)^2, 2*p(2)+p(1)-p(1)^2-2*p(1)*p(2);
               2*p(1)-p(2)-2*p(1)*p(2)+p(2)^2, 2*p(2)-p(1)-p(1)^2+2*p(1)*p(2);
               2*p(1)+p(2)+2*p(1)*p(2)+p(2)^2, 2*p(2)+p(1)+p(1)^2+2*p(1)*p(2);
               2*p(1)-p(2)+2*p(1)*p(2)-p(2)^2, 2*p(2)-p(1)+p(1)^2-2*p(1)*p(2);
               4*p(1)*p(2)-4*p(1), 2*p(1)^2-2;
               -2*p(2)^2+2, -4*p(1)*p(2)-4*p(2);
               -4*p(1)*p(2)-4*p(1), -2*p(1)^2+2;
               2*p(2)^2-2, 4*p(1)*p(2)-4*p(2)];

end